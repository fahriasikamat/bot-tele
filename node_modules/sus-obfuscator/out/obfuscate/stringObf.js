"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.stringObf = void 0;
const cfg_1 = require("../config/cfg");
const warn_1 = require("../log/warn");
const Randomizer_1 = require("../random/Randomizer");
const stringObfLvl1_1 = require("./stringObfLvl1");
const stringObfLvl2_1 = require("./stringObfLvl2");
const stringObfLvl3_1 = require("./stringObfLvl3");
const StringToArrayExtr_1 = require("./StringToArrayExtr");
function stringObf(str, ovL, extractToArray) {
    const l = ovL ?? (0, cfg_1.cfg)().transforms.stringObfLevel;
    const toArray = extractToArray ?? ((0, cfg_1.cfg)().transforms.extractStringsToArray === 'Random')
        ? Randomizer_1.Randomizer.INSTANCE.randBool()
        : (0, cfg_1.cfg)().transforms.extractStringsToArray;
    if (l === 0)
        return JSON.stringify(str);
    if (toArray) {
        return StringToArrayExtr_1.StringToArrayExtr.add(str);
    }
    else {
        if (l === 1)
            return (0, stringObfLvl1_1.stringObfLvl1)(str);
        if (l === 2)
            return (0, stringObfLvl2_1.stringObfLvl2)(str);
        if (l === 3)
            return (0, stringObfLvl3_1.stringObfLvl3)(str);
    }
    (0, warn_1.warn)(`stringObf(${str}) about to return undefined, l = ${l}; ovL = ${ovL}`);
}
exports.stringObf = stringObf;
